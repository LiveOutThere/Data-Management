SELECT a.name, a.sku, a.department, b.QTY
FROM LOT_Inventory.dbo.tbl_LoadFile_FW13_ARC AS a
INNER JOIN
(SELECT Style, SUM(CAST(Quantity AS float)) AS QTY FROM tbl_Arcteryx WHERE Style IN(
'10173',
'10980',
'10981',
'10982',
'10983',
'11034',
'11114',
'11115',
'11116',
'11117',
'12537',
'12645',
'12646',
'12655',
'12656',
'12657',
'12685',
'12691',
'12692',
'12910',
'12911',
'12938',
'13135',
'5914',
'6262',
'6264',
'6265',
'6416',
'6419',
'6421',
'6577',
'6845',
'7026',
'7058',
'7059',
'7299',
'7300',
'8246',
'8559',
'8560',
'8632',
'9491',
'9492',
'9505',
'9508',
'9797',
'9825',
'9826',
'9981',
'9983')
GROUP BY Style
HAVING SUM(CAST(Quantity AS float)) > 0) AS b
ON a.vendor_product_id COLLATE Latin1_General_CI_AS = b.Style COLLATE Latin1_General_CI_AS AND a.type = 'configurable'
ORDER BY b.QTY DESC